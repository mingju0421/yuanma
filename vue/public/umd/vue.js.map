{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export const isObject = data => typeof data == 'object' && data\n\nexport function def (data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false, // 不可枚举\n    configurable: false, // 不可配置\n    value: value\n  })\n}","// 需要重写数组的方法 7 个: push shift unshift pop reverse sort splice reverse 会导致原数组发生变化\n\nlet oldArrayMethods = Array.prototype\n// value.__proto__ = arrayMethods\n// arrayMethods.__proto__ = oldArrayMethods\n// 原型链查找\nexport const arrayMethods = Object.create(oldArrayMethods)\nconst methods = ['push', 'shift', 'unshift', 'pop', 'sort', 'splice', 'reverse']\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    console.log('用户调用了', method)\n    const result = oldArrayMethods[method].apply(this, args) // 调用原生数组方法\n    // 添加的元素可能还是一个对象\n    let inserted // 当前用户插入的元素\n    let ob = this.__ob__\n    switch ((method)) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break;\n      case 'splice':  // 3个参数\n        inserted = args.slice(2)\n      default:\n        break;\n    }\n    if (inserted) ob.observerArray(inserted)  // 将新增属性继续观测\n    return result\n  }\n})","// 把 data 中的数据, 都使用 object.defineProperty 重新定义, 不兼容 ie8 及以下\nimport { def, isObject } from '../util/index'\nimport { arrayMethods } from './array.js'\nclass Observer {\n  constructor(value) {\n    // vue 如果数据的层次过多, 需要递归去解析对象中的属性, 一次增加 set 和 get 方法\n    console.log(value)\n    // value.__ob__ = this // 给每一个监听过的对象都增加一个__ob__属性\n    def(value, '__ob__', this)\n    if (Array.isArray(value)) {\n      // 如果是数组的话, 并不会对索引进行观测, 因为会导致性能问题\n      // 前端开发中, 很少去操作索引\n      // 如果数组里放的是对象, 在监控\n      value.__proto__ = arrayMethods\n      this.observerArray(value)\n    } else {\n      this.walk(value) // 对对象进行观测\n    }\n  }\n  observerArray (value) {\n    for (let item of value) {\n      observe(item)\n    }\n  }\n  walk (data) {\n    let keys = Object.keys(data)\n    for (let key of keys) {\n      let value = data[key]\n      defineReactive(data, key, value) // 定义响应式数据\n    }\n  }\n}\nfunction defineReactive (data, key, value) {\n  observe(value)\n  Object.defineProperty(data, key, {\n    get () { // 获取值的时候, 做一些操作\n      return value\n    },\n    set (newValue) { // 设置值得时候, 做一些操作\n      console.log('update')\n      if (newValue === value) return\n      observe(value)\n      value = newValue\n    }\n  })\n}\nexport function observe (data) {\n  // 判断 data 是不是对象\n  if (!isObject(data)) return\n  return new Observer(data) // 用来观测数据\n}","/** 数据初始化 */\n\nimport { observe } from './observe/index'\nexport function initState (vm) {\n  const options = vm.$options\n  // vue 的数据来源 属性 方法 数据 计算属性 watch\n  if (options.props) {\n    initProps(vm)\n  }\n  if (options.methods) {\n    initMethod(vm)\n  }\n  if (options.data) {\n    initData(vm)\n  }\n  if (options.computed) {\n    initComputed(vm)\n  }\n  if (options.watch) {\n    initWatch(vm)\n  }\n}\n\nfunction initProps (vm) { }\nfunction initMethod (vm) { }\nfunction initData (vm) {\n  // 数据的初始化工作\n  // 用户传递的 data\n  let data = vm.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  // 对象劫持, 用户改变数据, 获得通知\n  // MVVM 模式, 数据变化驱动视图变化\n  // Object.defineProperty() 给属性增加 get 方法和 set 方法\n  observe(data)  // 响应式原理\n}\nfunction initComputed (vm) { }\nfunction initWatch (vm) { }","import { initState } from './state'\nexport function initMixin (Vue) {\n  // 进行 Vue 的初始化操作\n  Vue.prototype._init = function (option) {\n    // 数据的劫持\n    const vm = this\n    // vue 中使用 this.$options 指代的就是用户传递的属性\n    vm.$options = option\n\n    // 初始化状态\n    initState(vm)  // 分割代码\n  }\n}","// vue 的核心代码, 只是 vue 的声明\n\nimport { initMixin } from './init'\n\nfunction Vue (option) {\n  this._init(option)\n}\n// 通过引入文件的方式, 给 vue 原型上添加方法\ninitMixin(Vue)\nexport default Vue\n"],"names":[],"mappings":"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"}