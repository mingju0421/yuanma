<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模拟实现 new 操作符</title>
</head>

<body>
    <script>
        /**
            new 运算符创建一个用户定义的对象类型的实例或具有构造函数的内置对象的实例.
            new 关键字会进行如下的操作:
            1. 创建一个空的简单 JavaScript 对象({})
            2. 连接该对象到另一个对象
            3. 将新创建的对象作为 this 的上下文
            4. 如果该函数没有返回对象, 则返回 this
        */
        function new_object(fn, ...args) {
            // 创建一个空对象
            let obj = {}
            // 绑定 this, 执行构造函数
            let result = fn.apply(obj, args)
            // 确保 new 出来的是一个对象
            return typeof result === 'object' ? result : obj
        }
        function Perple(name, age, gender) {
            this.name = name
            this.age = age
            this.gender = gender
        }
        let 李四 = new Perple('李四', 19, '男')
        let 张三 = new_object(Perple, '张三', 18, '男')
        console.log(张三, 李四)
    </script>
</body>

</html>